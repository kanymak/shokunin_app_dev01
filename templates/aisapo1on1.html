<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <!-- モバイル向けviewport設定 -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>相棒〈AI:bou〉のサポート</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dist/output.css') }}">
  <!--<link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">-->
</head>
<body class="bg-gray-100 p-2 font-sans">
  <div class="okr-container max-w-4xl mx-auto p-4 bg-white shadow-md rounded-md">
    <div class="text-right mb-4">
      <a href="{{ url_for('index') }}" class="text-blue-600 hover:underline">【ホームに戻る】</a>
    </div>
    <!-- ヘッダー -->
    <div class="header text-center mb-8">
      <h1 class="text-3xl font-semibold text-gray-800">相棒〈AI:bou〉のサポート</h1>
      <p class="text-gray-600">職人として上を目指ざそう！。<br>あなたの成長をAIがサポートします。</p>
    </div>

    <!-- セクション1: 評価データのトレンド解析 -->
    <div class="section" id="trend-analysis">
      <h2 class="text-xl font-semibold text-gray-700 mb-4"><span class="icon">📊</span>評価データの解析と今後の取り組み</h2>
      <p class="text-gray-600 leading-relaxed">
        過去の評価やOKR、1on1の対話内容をもとに、あなたの強みや改善点をわかりやすく解析。
        <br>親身なアドバイザーとして、今後の取り組み方を提案します。
      </p>
      <div class="chart-placeholder bg-gray-100 border-2 border-dashed border-gray-300 rounded-md p-4 flex items-center justify-center text-gray-500">
        グラフイメージ
      </div>
      <button class="btn px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700" onclick="showTrendAnalysis()">解析結果を見る</button>
    </div>
    
    <!-- セクション2: 「お知らせ」や「気づき」のためのメッセージ -->
    <div class="section mt-8" id="realtime-alert">
      <h2 class="text-xl font-semibold text-gray-700 mb-4"><span class="icon">⏰</span>「お知らせ」や「気づき」のためのメッセージ</h2>
      <p class="text-gray-600 leading-relaxed">
        評価入力の遅れやOKRの進捗停滞など、気づきのためのサポートメッセージをお届け。<br>
        あなたの具体的な行動を促します。
      </p>
      <div class="alert-placeholder bg-yellow-50 border border-yellow-200 rounded-md p-4 text-yellow-700">
        リマインダー例：OKRの進捗入力がまだのようです。少しだけ今の状況を見直してみませんか？
      </div>
      <button class="btn px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700" onclick="triggerAlert()">テストアラートを確認</button>
    </div>
    
    <!-- セクション3: コーチング -->
    <div class="section mt-8" id="sentiment-analysis">
      <h2 class="text-xl font-semibold text-gray-700 mb-4"><span class="icon">🙂</span>コーチング</h2>
      <p class="text-gray-600 leading-relaxed">
        あなたの対話内容から、ストレスやモチベーションなど、感情面の変化を解析します。<br>
        必要なときに、リラックスやセルフケアのアドバイスをお伝えします。
      </p>
      <div class="chart-placeholder bg-gray-100 border-2 border-dashed border-gray-300 rounded-md p-4 flex items-center justify-center text-gray-500">
        感情分析結果イメージ
      </div>
      <button class="btn px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700" onclick="showSentimentAnalysis()">感情分析結果を見る</button>
    </div>
    
    <!-- セクション4: AIキャラクターとの1on1セッション -->
    <div class="section mt-8" id="ai-chat-session">
      <h2 class="text-xl font-semibold text-gray-700 mb-4"><span class="icon">👱‍♂️</span>お話ししましょう！</h2>
      <p class="text-gray-600 leading-relaxed">
        リラックスして、気軽に話せる<b> 相棒〈AI:bou〉</b>がいます。<br>
        上司や仲間には言いにくいことも、ここならちょっと語っても大丈夫です。
      </p>
      <div class="chat-container border border-gray-200 rounded-md bg-white p-4">
        <div id="chat-messages" class="chat-messages h-64 overflow-y-auto p-2 bg-gray-50 border border-gray-200 rounded-md mb-2">
          <!-- 初回メッセージ：AIキャラクターのアバター付き -->
          <div class="message ai-message bg-blue-100 text-blue-800 rounded-md p-2 mb-2 relative pl-12">
            こんにちは！なにか悩みがあれば、気軽に話してみてくださいね。
          </div>
        </div>
        <div class="chat-input flex items-center">
          <input type="text" id="userInput" class="flex-grow border border-gray-300 rounded-md p-2 mr-2" placeholder="ここにメッセージを入力">
          <button class="btn-small px-3 py-1 bg-green-500 text-white rounded hover:bg-green-700" onclick="sendMessage()">送信</button>
          <button class="btn-small px-3 py-1 bg-gray-300 text-gray-700 rounded hover:bg-gray-400" onclick="sendMessage()">音声で</button>
        </div>
      </div>
    </div>
    
    <div class="flex justify-center mt-6">
      <a href="{{ url_for('index') }}" class="text-blue-600 hover:underline">【ホームに戻る】</a>
    </div>
    <div class="flex justify-center mt-6">
      <a href="{{ url_for('employee_history', employee_id=employee_id) }}" class="text-blue-600 hover:underline">自分の履歴を見る</a>
    </div>
  </div>

  <script>
    // 評価データのトレンド解析のサンプル動作
    function showTrendAnalysis() {
      alert("解析結果: 過去6ヶ月のデータから、あなたの強みは『コミュニケーション』、改善点は『タイムマネジメント』と分析されました。今後はリーダーシップ研修の受講をお勧めします。");
    }
    
    // リアルタイムなアラートとリマインダーのサンプル動作
    function triggerAlert() {
      alert("リマインダー: OKRの進捗入力が滞っています。今のうちに少しだけ確認してみましょう！");
    }
    
    // 感情分析によるコーチング支援のサンプル動作
    function showSentimentAnalysis() {
      alert("感情分析結果: 最近の対話から、ややストレスが溜まっている傾向が見受けられます。リラックスするための短い休憩や、気分転換をお勧めします。");
    }
    
    // AIキャラクターとの1on1チャット機能
    function sendMessage() {
      var input = document.getElementById('userInput');
      var text = input.value.trim();
      if (text === "") return;
      
      appendMessage("user", text);
      input.value = "";
      
      // シンプルなAI応答シミュレーション（実際にはAIチャットボットAPIと連携）
      setTimeout(function() {
        var aiResponse = generateAIResponse(text);
        appendMessage("ai", aiResponse);
      }, 1000);
    }
    
    function appendMessage(sender, message) {
      var chatMessages = document.getElementById('chat-messages');
      var messageDiv = document.createElement('div');
      messageDiv.classList.add('message');
      if (sender === "ai") {
        messageDiv.classList.add('ai-message');
        // AIキャラクターのアバターを追加する場合（既に最初のメッセージには含んでいます）
        // ここでは省略。必要なら、常にアバターを表示するロジックを追加します。
      } else {
        messageDiv.classList.add('user-message');
      }
      messageDiv.innerText = message;
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;
    }
    
    function generateAIResponse(userText) {
      // シンプルなシミュレーション。実際には、ユーザーの入力内容に合わせた柔軟な返答を返します。
      return "なるほど、「" + userText + "」ということですね。もう少し詳しくお話しいただけますか？";
    }
  </script>

</body>
</html>
